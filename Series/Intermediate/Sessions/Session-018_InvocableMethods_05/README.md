# Session-018: Invocable Methods (Part 5) - Sales Email Prompt Template Grounded with Apex (Arabic)

In this Arabic session from [Code With Sally](https://youtube.com/@codewithsally), we implement a complete **Sales Email Prompt Template** grounded with Apex to eliminate hallucinations and deliver personalized property suggestions for real estate agents.

This is Part 5 in our Salesforce Apex Invocable Methods series (Arabic), where we walk through enabling AI and Email for Sales features, assigning permissions, building the prompt template, and grounding it with an **Apex Invocable Method** using real Salesforce data.

🎥 **Watch the full video:**  
https://youtu.be/DzsHnJcSCqs

---

## 🧠 What You'll Learn

- How to enable **AI Capabilities** and **Email for Sales** in your Salesforce org  
- Required **Permission Sets** for Prompt Templates  
- How to create and activate a **Sales Email Prompt Template**  
- How to ground a template using:
  - Merge fields only (initial test)
  - Apex Invocable Method

- 3 ways to prepare the Apex output:
  - 🔤 String concatenation  
  - 🔁 JSON serialization of a `List<SObject>`  
  - 📦 JSON serialization of a `List<WrapperClass>`

---

## 🧩 Files Included

### ⚙️ Apex Classes

- `PropertySimilarSalesEmailAction_Simplified.cls`  
  ➤ A basic method that queries similar properties and serializes the list of SObjects to a JSON string.

- `PropertySimilarSalesEmailAction_Advanced.cls`  
  ➤ An advanced method that uses dynamic SOQL, filters properties, and returns a list of custom wrapper classes as a JSON string.

### 📄 Prompt Template Files

- `genAiPromptTemplates/Similar_Properties_Email.genAiPromptTemplate-meta.xml`  
  ➤ Prompt Template metadata file used for the grounded Sales Email.

- `genAiPromptTemplates/PromptTemplateText`  
  ➤ Raw prompt template text with merge fields.

---

## 🏡 Use Case

Realtors want to send follow-up emails to clients that show:

- The main property they showed interest in  
- A table of similar properties generated by Apex logic  
- Grounded using Prompt Templates with **real data** to eliminate AI hallucinations

---

## 🔗 Helpful Resources

- [Create a Playground with Sales Email Enabled](https://trailhead.salesforce.com/content/learn/projects/quick-start-create-a-sales-email-prompt-template/get-started-with-sales-email-prompt-templates)  
- [Install Dreamhouse App](https://trailhead.salesforce.com/content/learn/projects/quick-start-dreamhouse-sample-app/deploy-the-app-dreamhouse)  
- [Salesforce Help - Apex Grounding Docs](https://help.salesforce.com/s/articleView?id=ai.prompt_builder_ground_apex.htm&type=5)  
- [Salesforce Dev Blog: Ground Prompt Templates](https://developer.salesforce.com/blogs/2024/04/ground-your-prompt-templates-with-data-using-flow-or-apex?utm_source=chatgpt.com)

---

## ▶️ Related Videos in This Series

1. **Part 1:** Record-Triggered Flows  
   https://youtu.be/-U1nJzlmf9U  
2. **Part 2:** Passing Lists & Wrapper Classes, Unit Testing  
   https://youtu.be/mueKfjmjjzI  
3. **Part 3:** Screen Flow + External API Callout  
   https://youtu.be/G9AUEhC9Eec  
4. **Part 4:** Prompt Templates Explained  
   https://youtu.be/WE3t7gwTdik  

---

## 🙌 Support the Channel

If you find this useful, please give the video a 👍, leave a comment, and **subscribe** to [Code With Sally](https://youtube.com/@codewithsally) for more Arabic Salesforce content!